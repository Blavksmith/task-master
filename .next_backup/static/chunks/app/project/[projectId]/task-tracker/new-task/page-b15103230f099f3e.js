(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(5155);r(2115);var s=r(9708),i=r(2085),n=r(9434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:r,size:i,asChild:l=!1,...d}=e,c=l?s.Slot:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,n.cn)(o({variant:r,size:i,className:t})),...d})}},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var a=r(5155);r(2115);var s=r(9434);function i(e){let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}},5764:(e,t,r)=>{Promise.resolve().then(r.bind(r,9605))},6927:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(3579).createClientComponentClient)()},7262:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});var a=r(5155);r(2115);var s=r(6981),i=r(5196),n=r(9434);function o(e){let{className:t,...r}=e;return(0,a.jsx)(s.bL,{"data-slot":"checkbox",className:(0,n.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,a.jsx)(s.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(i.A,{className:"size-3.5"})})})}},7438:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var a=r(5155);r(2115);var s=r(968),i=r(9434);function n(e){let{className:t,...r}=e;return(0,a.jsx)(s.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},8539:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var a=r(5155);r(2115);var s=r(9434);function i(e){let{className:t,...r}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var a=r(2596),s=r(9688);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},9605:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var a=r(5155),s=r(6874),i=r.n(s),n=r(2115),o=r(6927),l=r(6671),d=r(5695),c=r(285),u=r(2523),m=r(7438),x=r(8539),g=r(7262),h=r(17),p=r(6474),b=r(5196),v=r(7863),f=r(9434);function y(e){let{...t}=e;return(0,a.jsx)(h.bL,{"data-slot":"select",...t})}function j(e){let{...t}=e;return(0,a.jsx)(h.WT,{"data-slot":"select-value",...t})}function w(e){let{className:t,size:r="default",children:s,...i}=e;return(0,a.jsxs)(h.l9,{"data-slot":"select-trigger","data-size":r,className:(0,f.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[s,(0,a.jsx)(h.In,{asChild:!0,children:(0,a.jsx)(p.A,{className:"size-4 opacity-50"})})]})}function N(e){let{className:t,children:r,position:s="popper",...i}=e;return(0,a.jsx)(h.ZL,{children:(0,a.jsxs)(h.UC,{"data-slot":"select-content",className:(0,f.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...i,children:[(0,a.jsx)(_,{}),(0,a.jsx)(h.LM,{className:(0,f.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),(0,a.jsx)(z,{})]})})}function k(e){let{className:t,children:r,...s}=e;return(0,a.jsxs)(h.q7,{"data-slot":"select-item",className:(0,f.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(h.VF,{children:(0,a.jsx)(b.A,{className:"size-4"})})}),(0,a.jsx)(h.p4,{children:r})]})}function _(e){let{className:t,...r}=e;return(0,a.jsx)(h.PP,{"data-slot":"select-scroll-up-button",className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(v.A,{className:"size-4"})})}function z(e){let{className:t,...r}=e;return(0,a.jsx)(h.wn,{"data-slot":"select-scroll-down-button",className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(p.A,{className:"size-4"})})}var C=r(7550),S=r(5561);let A=e=>{let{value:t,display:r,index:s}=e;return(0,a.jsx)(S.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.02*s},children:(0,a.jsx)(k,{value:t,className:"text-black",children:r},t)})};function T(){let e=(0,d.useRouter)(),[t,r]=(0,n.useState)(null),[s,h]=(0,n.useState)([]),[p,b]=(0,n.useState)({title:"",description:"",priority:"medium",project_id:"",day:"",month:"",year:"",hour:"",minute:"",ampm:""}),[v,f]=(0,n.useState)(!1),[k,_]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let{data:{user:e}}=await o.N.auth.getUser();if(e){let{data:s,error:i}=await o.N.from("users").select("id").eq("id",e.id).single();if(i&&"PGRST116"===i.code){var t,a;let{error:r}=await o.N.from("users").insert([{id:e.id,full_name:(null==(t=e.user_metadata)?void 0:t.full_name)||e.email||"Unknown User",avatar_url:(null==(a=e.user_metadata)?void 0:a.avatar_url)||null}]);if(r){console.error("Error creating user profile:",r),l.oR.error("Failed to create user profile");return}}r(e.id);let{data:n,error:d}=await o.N.from("projects").select("id, name").eq("owner_id",e.id);!d&&n&&h(n)}})()},[]);let z=e=>{let{name:t,value:r}=e.target;b(e=>({...e,[t]:r}))},S=(e,t)=>{b(r=>({...r,[e]:t}))},T=async r=>{if(r.preventDefault(),!t)return l.oR.error("You must be logged in to create a task!");if(!k)return l.oR.error("Please confirm that the task details are correct!");if(!p.title.trim())return l.oR.error("Task title is required!");f(!0);try{let r=null;if(p.day&&p.month&&p.year&&p.hour&&p.minute&&p.ampm){let e=parseInt(p.hour),t="pm"===p.ampm&&e<12?e+12:12===e&&"am"===p.ampm?0:e;r=(r=new Date(Number(p.year),Number(p.month)-1,Number(p.day),t,Number(p.minute))).toISOString()}let a=p.priority||"medium",s={title:p.title.trim(),description:p.description.trim()||null,priority:a,status:"todo",assignee_id:t,due_date:r,project_id:p.project_id||null};console.log("Sending task data:",s);let{data:i,error:n}=await o.N.from("tasks").insert([s]).select();n?(console.error("Detailed error:",n),console.error("Error code:",n.code),console.error("Error message:",n.message),console.error("Error details:",n.details),console.error("Error hint:",n.hint),"23503"===n.code?l.oR.error("Invalid project or user reference. Please try again."):"23514"===n.code?l.oR.error("Invalid priority or status value. Please check your selections."):l.oR.error("Failed to create task: ".concat(n.message))):(console.log("Task created successfully:",i),l.oR.success("Task created successfully!"),e.push("/project/".concat(p.project_id,"/task-tracker")))}catch(e){console.error("Unexpected error:",e),l.oR.error("An unexpected error occurred")}finally{f(!1)}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"container mx-auto px-8 py-10",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(i(),{href:"../",className:"text-black hover:text-gray-900 mr-4",children:(0,a.jsx)(C.A,{className:"h-5 w-5"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-black",children:"New Task"})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-300 p-6",children:(0,a.jsxs)("form",{className:"space-y-6",onSubmit:T,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"task-name",className:"text-gray-700 font-normal",children:"Task Name *"}),(0,a.jsx)(u.p,{id:"task-name",name:"title",placeholder:"Enter task name",className:"mt-1 w-full text-gray-700 border-gray-300",onChange:z,value:p.title,required:!0})]}),s.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"project",className:"".concat(p.project_id?"text-gray-700":"text-black"," font-normal"),children:"Project (Optional)"}),(0,a.jsxs)(y,{onValueChange:e=>S("project_id",e),children:[(0,a.jsx)(w,{id:"project",className:"mt-1 w-full bg-white ".concat(p.project_id?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Select a project (optional)..."})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:s.map((e,t)=>(0,a.jsx)(A,{value:e.id,display:e.name,index:t},e.id))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"due-date",className:"".concat(p.day||p.month||p.year?"text-gray-700":"text-black"," font-normal"),children:"Due Date (Optional)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-1",children:[(0,a.jsxs)(y,{onValueChange:e=>S("day",e),children:[(0,a.jsx)(w,{id:"day",className:"bg-white ".concat(p.day?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Day"})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:Array.from({length:31},(e,t)=>t+1).map((e,t)=>(0,a.jsx)(A,{value:e.toString(),display:e,index:t},e))})]}),(0,a.jsxs)(y,{onValueChange:e=>S("month",e),children:[(0,a.jsx)(w,{id:"month",className:"bg-white ".concat(p.month?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Month"})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((e,t)=>(0,a.jsx)(A,{value:(t+1).toString(),display:e,index:t},e))})]}),(0,a.jsxs)(y,{onValueChange:e=>S("year",e),children:[(0,a.jsx)(w,{id:"year",className:"bg-white ".concat(p.year?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Year"})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:Array.from({length:5},(e,t)=>new Date().getFullYear()+t).map((e,t)=>(0,a.jsx)(A,{value:e.toString(),display:e,index:t},e))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"due-time",className:"".concat(p.hour||p.minute||p.ampm?"text-gray-700":"text-black"," font-normal"),children:"Due Time (Optional)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-1",children:[(0,a.jsxs)(y,{onValueChange:e=>S("hour",e),children:[(0,a.jsx)(w,{id:"hour",className:"bg-white ".concat(p.hour?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Hour"})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:Array.from({length:12},(e,t)=>t+1).map((e,t)=>(0,a.jsx)(A,{value:e.toString(),display:e,index:t},e))})]}),(0,a.jsxs)(y,{onValueChange:e=>S("minute",e),children:[(0,a.jsx)(w,{id:"minute",className:"bg-white ".concat(p.minute?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"Minutes"})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:["00","15","30","45"].map((e,t)=>(0,a.jsx)(A,{value:e,display:e,index:t},e))})]}),(0,a.jsxs)(y,{onValueChange:e=>S("ampm",e),children:[(0,a.jsx)(w,{id:"am-pm",className:"bg-white ".concat(p.ampm?"text-gray-700":"text-gray-400"," border-gray-300"),children:(0,a.jsx)(j,{placeholder:"AM"})}),(0,a.jsx)(N,{className:"bg-white transition-transform duration-300 ease-in-out",children:["AM","PM"].map((e,t)=>(0,a.jsx)(A,{value:e.toLowerCase(),display:e,index:t},e))})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"task-priority",className:"text-gray-700 font-normal",children:"Task Priority"}),(0,a.jsxs)(y,{onValueChange:e=>S("priority",e),value:p.priority,children:[(0,a.jsx)(w,{id:"task-priority",className:"mt-1 w-full bg-white text-gray-700 border-gray-300",children:(0,a.jsx)(j,{placeholder:"Select Task Priority..."})}),(0,a.jsx)(N,{className:"transition-transform duration-300 ease-in-out bg-white",children:[{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}].map((e,t)=>(0,a.jsx)(A,{value:e.value,display:e.label,index:t},e.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(m.J,{htmlFor:"task-description",className:"text-black font-normal",children:"Task Description (Optional)"}),(0,a.jsx)(x.T,{id:"task-description",name:"description",placeholder:"Enter task description",className:"mt-1 w-full h-32 text-black border-gray-300",value:p.description,onChange:z})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.S,{id:"confirm",className:"border-gray-300 text-gray-700",checked:k,onCheckedChange:e=>_(e)}),(0,a.jsx)("label",{htmlFor:"confirm",className:"text-gray-700 text-sm font-normal leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"I'm sure this task is correct"})]}),(0,a.jsx)(c.$,{type:"submit",className:"w-full bg-gray-800 hover:bg-black text-white cursor-pointer",disabled:v||!k,children:v?"Creating Task...":"Save Task"})]})})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[37,778,579,671,557,561,687,944,441,684,358],()=>t(5764)),_N_E=e.O()}]);